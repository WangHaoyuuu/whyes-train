[tox]
requires = tox>=4.6 tox-uv>=1.11.3
envlist = py{39,310,311,312,313}
skipsdist = true

[gh-actions]
python =
    3.9: py39
    3.10: py310
    3.11: py311
    3.12: py312
    3.13: py313

[testenv]
description = Run tests and type checks with uv-managed env
passenv =
    CI
    PYTEST_ADDOPTS
    PYTHONWARNINGS
    CUDA_VISIBLE_DEVICES
    WANDB_*
    HF_*
allowlist_externals = uv
commands_pre =
    uv sync --all-groups
commands =
    uv run python -m pytest --cov=src --cov=tests --cov-report=term-missing --cov-report=xml:{toxworkdir}/coverage.xml {posargs}
    uv run mypy